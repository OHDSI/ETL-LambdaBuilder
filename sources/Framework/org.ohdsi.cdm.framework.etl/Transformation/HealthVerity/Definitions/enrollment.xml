<QueryDefinition>
	<Query>
		with a as
		(
		select
		ch.person_id as PersonId,
		date_start,
		date_end,
		payer_type,
		case lower(coalesce(a.payer_type, ''))
		when 'medicaid' then 289
		when 'commercial' then 327
		when 'medicare' then 281
		when 'medicare advantage' then 281
		else 0
		end as payer_concept_id
		FROM {sc}.enrollment
		JOIN {ch_sc}._chunks ch ON ch.ChunkId = {0} AND hvid = ch.PERSON_SOURCE_VALUE
		where replace(data_vendor, ' - Enrollment', '') {param1}
		)

		select a.*
		from a
		order by 1
	</Query>
	<PayerPlanPeriods>
		<PayerPlanPeriodDefinition>
			<PersonId>PersonId</PersonId>
			<StartDate>date_start</StartDate>
			<EndDate>date_end</EndDate>
			<Concepts>
				<Concept>
					<Fields>
						<Field conceptId="payer_concept_id" key="payer_type" sourceKey="payer_type" defaultTypeId="0"/>
					</Fields>
				</Concept>
			</Concepts>
		</PayerPlanPeriodDefinition>
	</PayerPlanPeriods>
</QueryDefinition>