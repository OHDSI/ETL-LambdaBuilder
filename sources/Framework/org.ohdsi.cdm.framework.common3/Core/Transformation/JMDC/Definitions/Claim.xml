<QueryDefinition>
  <Query>
		SELECT CAST(RIGHT(Member_ID, LEN(Member_ID) - 1) AS BIGINT) AS person_id,
		CAST(RIGHT(Claim_ID, LEN(Claim_ID) - 1) AS BIGINT) AS visit_occurrence_id,
		Type_of_claim as place_of_service_source_value,
		CAST(CAST(month_and_year_of_medical_care AS VARCHAR(6)) + '15' AS DATE) AS visit_start_date,
		actual_number_of_days_of_medical_care as num_of_days,
		CAST('1' + RIGHT(institution_id, LEN(institution_id) - 1) AS BIGINT) AS care_site_id,
		CASE
		WHEN Type_of_claim LIKE 'Outpatient' THEN 9202
		ELSE 9201
		END as place_of_service_concept_id
		FROM {sc}.Claim c
		JOIN {ch_sc}._chunks ch ON ch.ChunkId = {0} AND c.Member_ID = ch.PERSON_SOURCE_VALUE
		order by CAST(RIGHT(Member_ID, LEN(Member_ID) - 1) AS BIGINT)
	</Query>
  <VisitOccurrence>
    <VisitOccurrenceDefinition>
      <Id>visit_occurrence_id</Id>
      <PersonId>person_id</PersonId>
      <StartDate>visit_start_date</StartDate>
      <EndDate>visit_start_date</EndDate>
      <CareSiteId>care_site_id</CareSiteId>
      <AdditionalFields>
        <string>num_of_days</string>
      </AdditionalFields>
      <Concepts>
        <Concept>
          <Fields>
            <Field conceptId = "place_of_service_concept_id" sourceKey = "place_of_service_source_value" defaultTypeId = "32810"/>
          </Fields>
        </Concept>
      </Concepts>
    </VisitOccurrenceDefinition>
  </VisitOccurrence>
</QueryDefinition>